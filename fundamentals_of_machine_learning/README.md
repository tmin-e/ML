# Основы машинного обучения
**Цель проекта:** провести анализ и подготовить план действий по удержанию клиентов  
**Задачи:**   
- научиться прогнозировать вероятность оттока (на уровне следующего месяца) для каждого клиента;  
- сформировать типичные портреты клиентов: выделить несколько наиболее ярких групп и охарактеризовать их основные свойства;  
- проанализировать основные признаки, наиболее сильно влияющие на отток;  
-  сформулировать основные выводы и разработать рекомендации по повышению качества работы с клиентами:   
1) выделить целевые группы клиентов;  
2) предложить меры по снижению оттока;  
3) определить другие особенности взаимодействия с клиентами.  
### Библиотеки: 
   <p align="left">
  <img src="https://img.shields.io/badge/library-scipy-yellowgreen" alt="Scipy">
   <img src="https://img.shields.io/badge/library-pandas-brightgreen" alt="Pandas">
   <img src="https://img.shields.io/badge/library-numpy-blueviolet" alt="Numpy">
   <img src="https://img.shields.io/badge/library-matplotlib-blue" alt="Matplotlib">
   <img src="https://img.shields.io/badge/library-seaborn-yellow" alt="Seaborn">
  <img src="https://img.shields.io/badge/library-datetime-red" alt="Datetime">
  <img src="https://img.shields.io/badge/library-Plotly-orange" alt="Plotly">
  <img src="https://img.shields.io/badge/library-math-ff69b4" alt="Math">
</p>  

## Выводы и базовые рекомендации по работе с клиентами  

Был проведен анализ данных сети фитнес-центров «Культурист-датасаентист». По результатам проведенной предобработки изменены изменены названия колонок. После предобработки был проведен анализ данных и выяснено следующее:
- gender - примерно одинаковые значения и у оставшихся и у ушедших, соответственно этот признак не влияет на отток клиентов 
- near_location - в обоих случаях высокое значение, что означает, что большая часть и ушедших и оставшихся(а соответственно ВСЕХ) клиентов живет поблизости от фитнес-центра. Различие между строками небольшое, поэтому я скажу, что этот признак не влияет на отток клиентов(но при этом чаще уходят те, кто живет дальше)  
- partner - по этому показателю могу сказать, что он влияет на отток клиентов, только положительно, т.е. посетители, которые занимаются с партнерами остаются чаще  
- promo_friends -здесь та же ситуация, посетители, пришедшие по промокоду уходят реже  
- phone - 90% и там и там оставили телефоны, этот признак не влияет на отток клиентов  
- contract_period - этот признак влияет на отток клиентов тем, что посетители с абонементов уходят реже  
- group_visits - посетители, посещающие групповые занятия остаются чаще  
- age - этот признак не влияет на оттток клиентов  
- avg_additional_charges_total - люди чаще остаются в фитнес-клубе, если они пользуются другими услугами  
- month_to_end_contract - людям обидно уходить из фитнес-клуба, если их абонемент не закончен  
- lifetime - очень сильное положительное влияние(логично, чем дольше человек занимается в одном конкретном фитнес-клубе, тем меньше вероятность, что он оттуда перейдет в другой или забросит фитнес)  
-  avg_class_frequency_total - есть небольшая зависимость, у части, которая покидает фитнес-центр среднее количество раз посещений в неделю стремится к 1  
- avg_class_frequency_current_month - здесь разница еще заметнее, т.е. те, кто ушли, постепенно уменьшали количество походов в фитнес-зал в неделю  
- корреляция почти нулевая у признаков gender и phone  
- очень слабая корреляция у near_location,promo friends, , partner, group_visits, avg_additional_charges_total  
- слабая корреляция у contract_period, age, month_to_end_contract, avg_class_frequency_total  
- умеренная корреляция у lifetime, avg_class_frequency_current_month  
- В дальнейшем для построения моделей использовали "логистическую регрессию" и "случайный лес". При сравнении моделей лучшей оказалась логистическая регрессия, при чем по всем параметрам. Accuracy у нее 0.93, у "леса"-0.92, Precision у нее 0.86, у "леса"-0.84, Recall у нее 0.83, у "леса"-0.82, F1 у нее 0.85, у "леса"-0.83, но при этом разница небольшая.  
- После была проведена кластеризация, по результатам которой можно выделить от 4 до 6 кластеров. Было решено посетителей разбить на 5 групп. Кластеры имеют следующие характеристики:  
0 - 96% - живут поблизости, очень большой процент(78) ходят с партнером, самая большая длительность абонементов(почти 11 месяцев)ну и отталкиваясь от этого им дольше всего до завершения контракта  
1 - 86% - живут поблизости, главное отличие кластера - никто из него не оставил свой номер телефона, около 5 месяцев контракт  
2 - главная особенность - все живут далеко от фитнес-центра, очень низки процент(8) пришедших по промокоду от друзей, и самый низкий % посещения групповых занятий(22)  
3 - 100% живут близко, самый низкий период контракта(примерно 2 месяца), меньше всего доп покупок, самый короткий срок с первого обращения в фитнес-центр(2,4 месяца), самая маленькая частота посещений в неделю(около 1, когда остальные - около 2)  
4 - выделяются тем, что средний возраст - 30 лет и среднее количество посещений в недели - около 3
Также для каждого кластера была посчитана доля оттока.  
С большим преимуществом в 61.2% побеждает кластер 3, после чего идут второй, первый, четвертый и нулевой(самый маленький по оттоку) кластеры(а точнее, здесь наоборот, побеждает кластер 0)  

**Рекомендации:**  

-продвигать акцию "приведи друга"  
- делать скидки/акции/привлекательные предложения на более длительные контракты и на групповые занятия  
- не забывать про другие услуги фитнес-центра, т.к. их развитие также поспособствует развития сети фитнес-центров  
## Статус проекта - требует доработки(срок - до октября 2022)
